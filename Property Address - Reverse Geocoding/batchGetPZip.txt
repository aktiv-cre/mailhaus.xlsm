Sub vbaMacroBatchGetPropertyZip()
    Dim lastRow As Long
    Dim ws As Worksheet
    Set ws = ThisWorkbook.Sheets("Master Sheet") ' change this according to the name of sheet

    lastRow = ws.Cells(ws.Rows.Count, "Q").End(xlUp).Row ' Find the last row based on Street column (Q)
    
    Dim i As Long
    For i = 2 To lastRow ' Starting from row 2 (assuming row 1 is headers)
        ' Call GetZipCodeFromParsedAddress with Street, City, and State
        ws.Cells(i, "AA").Value = GetZipCodeFromParsedAddress(ws.Cells(i, "Q").Value, ws.Cells(i, "W").Value, ws.Cells(i, "Y").Value) ' these are the reference cells (mailing street 1, state, zip)
    Next i

    MsgBox "Zip codes applied to all rows in column AA."
End Sub

